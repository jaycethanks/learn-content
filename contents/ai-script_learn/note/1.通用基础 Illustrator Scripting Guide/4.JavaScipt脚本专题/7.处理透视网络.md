# 处理透视网络(perspective grid)

透视网格是Illustrator CC 2017中的一项新功能，它使您能够使用透视的既定法则在空间环境中创建和操作艺术。可以通过View > Perspective Grid菜单或工具栏中的透视工具启用透视网格。

SDK提供了一个用于通过编程方式处理透视网格的API，您的脚本可以在一定程度上访问此API。脚本可以：

- 使用预设值设置默认网格参数。
- 显示或隐藏网格。
- 设置活动平面。
- 在活动平面上透视绘制对象。
- 将对象带入透视。



## 使用透视预设


Illustrator提供了默认的网格参数预设，用于一点透视、二点透视和三点透视。这些预设的名称分别是 "[1P-NormalView]"、"[2P-NormalView]" 和 "[3P-NormalView]"。

以下脚本展示了如何通过编程方式选择二点透视预设：

```js
// 设置默认的一点透视预设
app.activeDocument.selectPerspectivePreset("[1P-Normal View]");
// 设置默认的二点透视预设
app.activeDocument.selectPerspectivePreset("[2P-Normal View]");
// 设置默认的三点透视预设
app.activeDocument.selectPerspectivePreset("[3P-Normal View]");
```

您还可以创建新的透视预设，将预设导出到文件，并从文件导入预设。以下脚本展示了如何导出和导入预设：

```js
// 创建新文档
var mydoc = app.documents.add();
// 将透视网格预设导出到文件
var exportPresetFile = new File("C:/scripting/PGPresetsExported")
mydoc.exportPerspectiveGridPreset(exportPresetFile);

// 创建新文档
var mydoc = app.documents.add();
// 从文件导入透视网格预设
var importPresetFile = new File("C:/scripting/PGPresets")
mydoc.importPerspectiveGridPreset(importPresetFile);
```



## 显示或隐藏网格(Show or hide the grid)

要通过脚本显示或隐藏透视网格，您可以使用`showPerspectiveGrid`方法。以下是一个示例：

```js
// 显示透视网格
app.activeDocument.showPerspectiveGrid = true;

// 隐藏透视网格
app.activeDocument.showPerspectiveGrid = false;
```



## 设置活动平面(Set the active plane)

透视网格平面类型包括：

- 左平面`PerspectiveGridPlaneType.LEFTPLANE`
- 右平面`PerspectiveGridPlaneType.RIGHTPLANE`
- 地平面`PerspectiveGridPlaneType.FLOORPLANE`
- 无效平面`PerspectiveGridPlaneType.NOPLANE`

对于一点透视网格，只有左平面和地平面是有效的。

以下脚本设置了活动透视平面：

```js
// 将左平面设置为活动平面
app.activeDocument.setPerspectiveActivePlane(PerspectiveGridPlaneType.LEFTPLANE);

// 将右平面设置为活动平面
app.activeDocument.setPerspectiveActivePlane(PerspectiveGridPlaneType.RIGHTPLANE);

// 将地平面设置为活动平面
app.activeDocument.setPerspectiveActivePlane(PerspectiveGridPlaneType.FLOORPLANE);
```



## 在透视网格上绘制

当透视网格启用时，绘图方法允许您在透视中绘制或操作对象。这个脚本创建一个新文档，显示一个两点透视网格，并在左平面上绘制艺术对象。

```js
//Create a new document
var mydoc = app.documents.add();

//Select the default two-point perspective preset
mydoc.selectPerspectivePreset("[2P-Normal View]");

//Display the perspective grid defined in the document
mydoc.showPerspectiveGrid();

//Check if active plane is set to left; if not, set it to left
if (mydoc.getPerspectiveActivePlane() != PerspectiveGridPlaneType.LEFTPLANE) {
  mydoc.setPerspectiveActivePlane(PerspectiveGridPlaneType.LEFTPLANE);
}

//Draw rectangle in perspective, then resize to 200% and move
var myrect = mydoc.pathItems.rectangle(30, -30, 30, 30, false);
myrect.resize(200, 200, true, false, false, false, 100, Transformation.TOPLEFT);
myrect.translate (-420, 480);

//Draw ellipse in perspective
var myellipse = mydoc.pathItems.ellipse(60, -60, 30, 30, false, true);

//Draw rounded rectangle in perspective
var myrrect = mydoc.pathItems.roundedRectangle(90, -90, 30, 30, 10, 10, false);

//Draw polygon in perspective
var mypoly = mydoc.pathItems.polygon(-105, 105, 15, 7, false);

//Draw star in perspective
var mystar = mydoc.pathItems.star(-135, 135, 15, 10, 6, false);

//Draw path in perspective
var newPath = mydoc.pathItems.add();
var lineList = new Array(4);
lineList[0] = new Array(0,0);
lineList[1] = new Array(60,0);
lineList[2] = new Array(30,45);
lineList[3] = new Array(90,110);
newPath.setEntirePath(lineList);
```



## 使对象呈现透视效果

如果艺术对象不处于透视状态，请使用`bringInPerspective()`方法将其带入透视，并将其放置在一个平面上。

这个脚本创建一个新文档，绘制一个艺术对象，并在一个三点透视网格上使其呈现透视效果：

```js
//Create a new document
var mydoc = app.documents.add();

//Draw ellipse
var myellipse = mydoc.pathItems.ellipse(60, -60, 30, 30, false, true);

//Draw polygon
var mypoly = mydoc.pathItems.polygon(-105, 105, 15, 7, false);

//Draw star
var mystar = mydoc.pathItems.star(-135, 135, 15, 10, 6, false);

//Select the default three-point perspective preset
mydoc.selectPerspectivePreset("[3P-Normal View]");

//Display the perspective grid defined in the document
mydoc.showPerspectiveGrid();

//Check if active plane is set to left; if not, set it to left
if (mydoc.getPerspectiveActivePlane() != PerspectiveGridPlaneType.LEFTPLANE) {
  mydoc.setPerspectiveActivePlane(PerspectiveGridPlaneType.LEFTPLANE);
}

//Bring the ellipse to the active plane (left plane)
myellipse.bringInPerspective(-100,-100, PerspectiveGridPlaneType.LEFTPLANE);

//Bring the polygon to the right plane
mypoly.bringInPerspective(100,-100,PerspectiveGridPlaneType.RIGHTPLANE);

//Bring the star to the floor plane
mystar.bringInPerspective(100,100,PerspectiveGridPlaneType.FLOORPLANE);
```

